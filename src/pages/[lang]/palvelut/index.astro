---
import Layout from "../../../layouts/Layout.astro";
import Services from "../../../components/astro/Services.astro";

const slugs = {
  en: { services: "services" },
  fi: { services: "palvelut" },
};

export async function getStaticPaths() {
  return [{ params: { lang: "en" } }, { params: { lang: "fi" } }];
}

const { lang } = Astro.params;
const currentPath = Astro.url.pathname;
const correctSlug = slugs[lang as keyof typeof slugs].services;
const correctPath = `/${lang}/${correctSlug}`;

// Redirect if someone tries to access the wrong URL format
// e.g., /en/palvelut -> /en/services
if (currentPath !== correctPath) {
  return Astro.redirect(correctPath);
}

const translations = await import(`../../../i18n/services/${lang}.json`);
---

<Layout title={lang}>
  <Services initialLang={lang} translations={translations.default} />
</Layout>
